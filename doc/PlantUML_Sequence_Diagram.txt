@startuml
title Project: Face Privacy

actor Person as per
boundary Edge_Device as edge
control Application as ctrl
participant Person_Detection_Model as person
participant Face_Recognition_Model as face
participant Gesture_Recognition_Model as gesture
participant Emotion_Recognition_Model as emotion

skinparam sequenceMessageAlign center

per -> edge: Use device

group Select Face
|||
edge -> ctrl: Select face
ctrl -> edge: Save face in database
|||
end

group Start streaming
|||
edge -> ctrl: Streaming
ctrl -> person: Process person detection
person -> person: Detect persons in image
person -> ctrl: Return person ROIs
loop For each detected person
    ctrl -> face: Process facial recognition
    face -> face: Check for face
    face -> ctrl: Return facial processing results
    ctrl -> gesture: Process gesture recognition
    gesture -> gesture: Check for hand gesture
    gesture -> ctrl: Return gesture processing results
    alt Registered face
        ctrl -> ctrl: Remove blur
    else Face unknown
        alt Gesture recognized (unblur)
            ctrl -> ctrl: Remove blur
        else Gesture recognized (emoticon)
            ctrl -> ctrl: Process emoticon
        end
    end
end
ctrl -> edge: Return video frame
edge -> per: Show processed video
|||
end

group Stop streaming
|||
edge -> ctrl: Stop
ctrl -> ctrl: Stop processing
ctrl -> edge: Terminate application
|||
end

group Save video
|||
edge -> ctrl: Save
ctrl -> edge: Save image locally
|||
end

@enduml
